<login-form>
    <div class="login">
        <h1>Member Authentication</h1>
        <form onsubmit="{handleLogin}">
            <div class="field">
                <p class="control has-icons-left">
                    <input name="user" type="text" value="" placeholder="Username or Email" required>
                    <span class="icon is-left"><i class="fa fa-user fa-fw"></i></span>
                </p>
            </div>
            <div class="field">
                <p class="control has-icons-left">
                    <input name="password" type="password" value="" placeholder="Password" required>
                    <span class="icon is-left"><i class="fa fa-lock fa-fw"></i></span>
                </p>
            </div>
            <div class="field">
                <p class="is-justified-left-and-right">
                    <span>Not a member yet? <a href="javascript:flipDialog();" class="fliplink">Join us!</a></span>
                    <span><button type="submit">Sign in</button></span>
                </p>
            </div>
        </form>
    </div>
    <script>
        this.mixin(ObservableMixin);
        var self = this
        this.handleLogin = (event) => {
            event.preventDefault()
            for (let i = 0; i < event.target.length; i++) {
                if (event.target[i].name == 'user') var user = event.target[i].value
                else if (event.target[i].name == 'password') var password = event.target[i].value
            }
            var authHeader = createAuthorizationHeader(user, password)
            qwest.get(config.urlNewSession, null, {
                headers: {
                    "Authorization": authHeader
                }
            })
                .then(function (xhr, response) {
                    self.observable.trigger(AUTH_SUCCESS, { user: user })
                })
                .catch(function (e, xhr, response) {
                    if (xhr.status == 401) self.observable.trigger(AUTH_FAILED, { user: user })
                    else self.observable.trigger(ERROR, e)
                })
            console.log("Sent AJAX request to " + config.urlNewSession)
        }
    </script>
</login-form>