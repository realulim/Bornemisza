<spinner style="display: flex; justify-content: center;">

	<img ref="spinner" if="{isLoading}" class="hidden" src="/img/progressbar.gif" />

	<script>
		this.mixin(ObservableMixin)
		var self = this
		this.delay = this.opts.delay ? this.opts.delay : 0
		this.isLoading = false

		this.observable.on(LOADING_IN_PROGRESS, function (opts) {
			self.isLoading = true
			self.update()
			setTimeout(function () {
				if (self.isLoading) {
					self.refs.spinner.classList.remove("hidden")
					root.style.opacity = "0.2"
				}
			}, self.delay)
		})
		this.observable.on(LOADING_DONE, function () {
			self.isLoading = false
			root.style.opacity = "1"
			self.update()
		})
	</script>

</spinner>